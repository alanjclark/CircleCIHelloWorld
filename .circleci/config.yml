version: 2

jobs:
  # rm_rvm:
  #   machine:
  #     image: ubuntu-2204:current
  #     resource_class: arm.large
  #   steps:
  #     - run: sudo rm -rf /opt/circleci/.rvm
  #     - run: sudo mkdir -p /mnt/ramdisk

  build:
    machine:
      image: ubuntu-2204:current
    resource_class: medium
    steps:
      - run: 
          name: Limit Docker to 1 concurrent download
          command: |
            sudo service docker stop
            sudo dockerd --max-concurrent-downloads 1
            sudo service docker start

  # implode_rvm:
  #   machine:
  #     image: ubuntu-2204:current
  #   resource_class: medium
  #   steps:
  #     - run: rvm implode --force
  #     - run: sudo mkdir -p /mnt/ramdisk


workflows:
  build_and_deploy:
    jobs:
      # - rm_rvm
      - build
      # - implode_rvm