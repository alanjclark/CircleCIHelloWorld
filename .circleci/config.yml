version: 2.1

orbs:
  mac-permissions: circleci/macos@1.1.0

parameters:
  pipelineSingleQuotes:
    type: string
    default: '1234567890'
  pipelineDoubleQuotes:
    type: string
    default: "1234567890"

jobs:
  permissions-check:

    macos:
      xcode: 12.5.0

    steps:
      - mac-permissions/add-permission:
          bundle-id: "com.apple.sshd"
          permission-type: "kTCCServiceScreenCapture"
      - run:
          name: Capture Screen
          command: screencapture -V2 ~/capture.mov
      - mac-permissions/list-permissions
      - mac-permissions/list-permission-types
             
workflows:
  version: 2
  build:
    jobs:
      - permissions-check
